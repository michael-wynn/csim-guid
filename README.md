# About csim-guid
cism-guid is a collision-resistant GUID (Globally-Unique-Identifier) generation tool based on [Eric Elliott][eric]'s [cuid][cuid], with additional consistency and flexibility measures which are important to large-scale enterprise applications.  Although intended for the RAD platform _CSIMplex_ (a work-in-progress), it is a standalone tool that may be use in any Node or browser application. 

## Motivations
Of course, the [same motivations stated by Eric](https://www.npmjs.com/package/cuid#motivation) apply.  This work also aims to achieve these additional benefits:

* Guarantee that reconstruction of date information is reliable (until Fri, 22 Apr 5188 GMT).
* Guarantee that GUIDs generated by same machine process will be alphabetically sequential. 
* Provide scaling option (higher scale = higher collision resistance/longer GUID).

## Status
Stable

## Installing

```bash
$ npm install --save csim-guid
```

## Referencing csim-guid
### Node JS
```js
var guidTool = require('csim-guid');
```
### Browsers
```html
<!script type='text/javascript' src='path to index.js file from this package'/>
```
and then
```js
var guidTool = window.$csim.csim_guid;
var newGuid = guidTool();
```
Note: all sources are contained in a single file; you may rename or distribute as part of a concatenated bundle.

## Usage

```js
var guidTool = require('../index');

/*Optional: set scale option once at app start.
Scale 1-2: use ONLY if database is expected to be small AND the user may be required to
    manually read/type id's from time to time. Generally not recommended!
Scale 3 (default): adequate for typical enterprise apps.
Scale 4-5: suitable for large enterprise apps / line-of-business clouds.
Scale 6+: suitable for very big public cloud apps (i.e. facebook/amazon scale). */
guidTool.setScale(4);    /* optional */

//Generate a new GUID:
var myGuid = guidTool();
console.log('1. My GUID: ', myGuid);

//Breakdown (deconstruct) a  GUID:
var details = guidTool.breakdown(myGuid);
console.log('2. Breakdown:\n', details);

/* Sample output:
 1. My GUID:  0icrrhi3vfddv1jor4n29zaorto6r
 2. Breakdown:
 { guid: '0icrrhi3vfddv1jor4n29zaorto6r',
 scale: 4,
 timestamp: '0icrrhi3v',
 counter: 'fddv',
 random: '1jor4n29zaorto6r',
 date: Fri Jul 31 2015 08:04:54 GMT-0700 (PDT),
 counterDecimal: 717187 }
*/
```

## Scale Option
The default scale is 3, meaning the random block of generated GUID will have 4x3, or 12 characters.  A scale of 5 then implies 20-character random block.  Once in production it will need to stay fixed forever.  You should consider the following when deciding on the scale option:
* The timestamp & counter blocks together already guarantee that all GUID's generated by the same machine-process are unique.  The random blocks are to alleviate collision between GUID's generated at the precise same millisecond (according to the machine clock) by different machine-processes.
* Default scale of 3 should be adequate for most enterprise internal applications.
* Determine scale based on likelihood of simultaneous GUID generation at multiple machines.  For example, a consumer app with multi-million concurrent, GUID-generating clients will demand the use of a higher scale.

## Internal Differences Compared to cuid

* Timestamp block is padded to 9-character fix length, ensuring sequential consistency until Apr 22 5188 (cuid does not pad the timestamp block, thus consistency will be broken on May 25 2059).
* Counter is reset on every timestamp change, effectively prevent rollover from occurring.  In cuid there is no such preemptive reset and rollover may take place at an unfortunate moment, breaking sequential characteristic.
* Counter resets at a process-dependent pseudo-random value (computed at startup) rather than 0.  This should produce similar effect to cuid's "finger print".
* There is no "finger print" block; the space is used for additional random characters instead. 
* There is no 'c' prefix. 
* There is no slug function.
* There is no reference to applitude framework.


### Credit
[Eric Elliott][eric]: author of original work [cuid][cuid], the base of this work.

[cuid]: https://www.npmjs.com/package/cuid "Original cuid npm package"
[eric]: https://www.npmjs.com/~ericelliott